{"version":3,"file":"baseProvider.cjs.js","mappings":"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","sources":["webpack://@web3auth/base-provider/webpack/bootstrap","webpack://@web3auth/base-provider/webpack/runtime/compat get default export","webpack://@web3auth/base-provider/webpack/runtime/define property getters","webpack://@web3auth/base-provider/webpack/runtime/hasOwnProperty shorthand","webpack://@web3auth/base-provider/webpack/runtime/make namespace object","webpack://@web3auth/base-provider/external commonjs2 \"@babel/runtime/helpers/classCallCheck\"","webpack://@web3auth/base-provider/external commonjs2 \"@babel/runtime/helpers/createClass\"","webpack://@web3auth/base-provider/external commonjs2 \"@babel/runtime/helpers/assertThisInitialized\"","webpack://@web3auth/base-provider/external commonjs2 \"@babel/runtime/helpers/inherits\"","webpack://@web3auth/base-provider/external commonjs2 \"@babel/runtime/helpers/possibleConstructorReturn\"","webpack://@web3auth/base-provider/external commonjs2 \"@babel/runtime/helpers/get\"","webpack://@web3auth/base-provider/external commonjs2 \"@babel/runtime/helpers/getPrototypeOf\"","webpack://@web3auth/base-provider/external commonjs2 \"@babel/runtime/helpers/defineProperty\"","webpack://@web3auth/base-provider/external commonjs2 \"@toruslabs/base-controllers\"","webpack://@web3auth/base-provider/external commonjs2 \"@web3auth/base\"","webpack://@web3auth/base-provider/external commonjs2 \"eth-rpc-errors\"","webpack://@web3auth/base-provider/./src/baseProvider.ts","webpack://@web3auth/base-provider/external commonjs2 \"@babel/runtime/helpers/asyncToGenerator\"","webpack://@web3auth/base-provider/external commonjs2 \"@babel/runtime/regenerator\"","webpack://@web3auth/base-provider/external commonjs2 \"@toruslabs/openlogin-jrpc\"","webpack://@web3auth/base-provider/./src/commonPrivateKeyProvider.ts","webpack://@web3auth/base-provider/external commonjs2 \"json-rpc-random-id\"","webpack://@web3auth/base-provider/./src/utils.ts","webpack://@web3auth/base-provider/./src/index.ts"],"sourcesContent":["// The require scope\nvar __webpack_require__ = {};\n\n","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = (module) => {\n\tvar getter = module && module.__esModule ?\n\t\t() => (module['default']) :\n\t\t() => (module);\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","const __WEBPACK_NAMESPACE_OBJECT__ = require(\"@babel/runtime/helpers/classCallCheck\");","const __WEBPACK_NAMESPACE_OBJECT__ = require(\"@babel/runtime/helpers/createClass\");","const __WEBPACK_NAMESPACE_OBJECT__ = require(\"@babel/runtime/helpers/assertThisInitialized\");","const __WEBPACK_NAMESPACE_OBJECT__ = require(\"@babel/runtime/helpers/inherits\");","const __WEBPACK_NAMESPACE_OBJECT__ = require(\"@babel/runtime/helpers/possibleConstructorReturn\");","const __WEBPACK_NAMESPACE_OBJECT__ = require(\"@babel/runtime/helpers/get\");","const __WEBPACK_NAMESPACE_OBJECT__ = require(\"@babel/runtime/helpers/getPrototypeOf\");","const __WEBPACK_NAMESPACE_OBJECT__ = require(\"@babel/runtime/helpers/defineProperty\");","const __WEBPACK_NAMESPACE_OBJECT__ = require(\"@toruslabs/base-controllers\");","const __WEBPACK_NAMESPACE_OBJECT__ = require(\"@web3auth/base\");","const __WEBPACK_NAMESPACE_OBJECT__ = require(\"eth-rpc-errors\");","import { BaseConfig, BaseController, BaseState, createEventEmitterProxy, SafeEventEmitterProvider } from \"@toruslabs/base-controllers\";\nimport { CustomChainConfig, WalletInitializationError } from \"@web3auth/base\";\nimport { ethErrors } from \"eth-rpc-errors\";\n\nimport { IBaseProvider } from \"./IBaseProvider\";\n\nexport interface BaseProviderState extends BaseState {\n  chainId: string;\n}\n\nexport interface BaseProviderConfig extends BaseConfig {\n  chainConfig: Partial<CustomChainConfig>;\n  networks?: Record<string, CustomChainConfig>;\n  skipLookupNetwork?: boolean;\n}\n\nexport abstract class BaseProvider<C extends BaseProviderConfig, S extends BaseProviderState, P>\n  extends BaseController<C, S>\n  implements IBaseProvider<P>\n{\n  // should be Assigned in setupProvider\n  public _providerEngineProxy: SafeEventEmitterProvider | null = null;\n\n  constructor({ config, state }: { config: C; state?: S }) {\n    super({ config, state });\n    if (!config.chainConfig) throw WalletInitializationError.invalidProviderConfigError(\"Please provide chainConfig\");\n    if (!config.chainConfig.chainId) throw WalletInitializationError.invalidProviderConfigError(\"Please provide chainId inside chainConfig\");\n    if (!config.chainConfig.rpcTarget) throw WalletInitializationError.invalidProviderConfigError(\"Please provide rpcTarget inside chainConfig\");\n    this.defaultState = {\n      chainId: \"loading\",\n    } as S;\n    this.defaultConfig = {\n      chainConfig: config.chainConfig,\n      networks: { [config.chainConfig.chainId]: config.chainConfig },\n    } as C;\n    super.initialize();\n  }\n\n  get provider(): SafeEventEmitterProvider | null {\n    return this._providerEngineProxy;\n  }\n\n  set provider(_) {\n    throw new Error(\"Method not implemented.\");\n  }\n\n  public addChain(chainConfig: CustomChainConfig): void {\n    if (!chainConfig.chainId) throw ethErrors.rpc.invalidParams(\"chainId is required\");\n    if (!chainConfig.rpcTarget) throw ethErrors.rpc.invalidParams(\"chainId is required\");\n    this.configure({\n      networks: { ...this.config.networks, [chainConfig.chainId]: chainConfig },\n    } as C);\n  }\n\n  public getChainConfig(chainId: string): CustomChainConfig | null {\n    const chainConfig = this.config.networks?.[chainId];\n    if (!chainConfig) throw ethErrors.rpc.invalidRequest(`Chain ${chainId} is not supported, please add chainConfig for it`);\n    return chainConfig;\n  }\n\n  protected getProviderEngineProxy(): SafeEventEmitterProvider | null {\n    return this._providerEngineProxy;\n  }\n\n  protected updateProviderEngineProxy(providerEngineProxy: SafeEventEmitterProvider) {\n    if (this._providerEngineProxy) {\n      (this._providerEngineProxy as any).setTarget(providerEngineProxy);\n    } else {\n      this._providerEngineProxy = createEventEmitterProxy<SafeEventEmitterProvider>(providerEngineProxy);\n    }\n  }\n\n  abstract setupProvider(provider: P): Promise<void>;\n\n  abstract switchChain(params: { chainId: string }): Promise<void>;\n\n  protected abstract lookupNetwork(provider?: P): Promise<string | void>;\n}\n","const __WEBPACK_NAMESPACE_OBJECT__ = require(\"@babel/runtime/helpers/asyncToGenerator\");","const __WEBPACK_NAMESPACE_OBJECT__ = require(\"@babel/runtime/regenerator\");","const __WEBPACK_NAMESPACE_OBJECT__ = require(\"@toruslabs/openlogin-jrpc\");","import { createEventEmitterProxy, providerFromEngine, SafeEventEmitterProvider } from \"@toruslabs/base-controllers\";\nimport { createAsyncMiddleware, createScaffoldMiddleware, JRPCEngine, JRPCMiddleware, JRPCRequest, JRPCResponse } from \"@toruslabs/openlogin-jrpc\";\nimport { CustomChainConfig } from \"@web3auth/base\";\n\nimport { IBaseProvider } from \"./IBaseProvider\";\n\nexport class CommonPrivateKeyProvider implements IBaseProvider<string> {\n  // should be Assigned in setupProvider\n  public _providerEngineProxy: SafeEventEmitterProvider | null = null;\n\n  get provider(): SafeEventEmitterProvider | null {\n    return this._providerEngineProxy;\n  }\n\n  set provider(_) {\n    throw new Error(\"Method not implemented.\");\n  }\n\n  public static getProviderInstance = async (params: { privKey: string }): Promise<CommonPrivateKeyProvider> => {\n    const providerFactory = new CommonPrivateKeyProvider();\n    await providerFactory.setupProvider(params.privKey);\n    return providerFactory;\n  };\n\n  addChain(_: CustomChainConfig): void {\n    throw new Error(\"Method not implemented.\");\n  }\n\n  public async setupProvider(privKey: string): Promise<void> {\n    const privKeyMiddleware = this.getPrivKeyMiddleware(privKey);\n    const engine = new JRPCEngine();\n    engine.push(privKeyMiddleware);\n    const provider = providerFromEngine(engine);\n    this.updateProviderEngineProxy(provider);\n  }\n\n  public async switchChain(_: { chainId: string }): Promise<void> {\n    return Promise.resolve();\n  }\n\n  protected getProviderEngineProxy(): SafeEventEmitterProvider | null {\n    return this._providerEngineProxy;\n  }\n\n  protected updateProviderEngineProxy(providerEngineProxy: SafeEventEmitterProvider) {\n    if (this._providerEngineProxy) {\n      (this._providerEngineProxy as any).setTarget(providerEngineProxy);\n    } else {\n      this._providerEngineProxy = createEventEmitterProxy<SafeEventEmitterProvider>(providerEngineProxy);\n    }\n  }\n\n  private getPrivKeyMiddleware(privKey: string): JRPCMiddleware<unknown, unknown> {\n    const middleware = {\n      getPrivatekey: async (): Promise<string> => {\n        return privKey;\n      },\n    };\n    return this.createPrivKeyMiddleware(middleware);\n  }\n\n  private createPrivKeyMiddleware({ getPrivatekey }): JRPCMiddleware<unknown, unknown> {\n    async function getPrivatekeyHandler(_: JRPCRequest<{ privateKey: string }[]>, res: JRPCResponse<unknown>): Promise<void> {\n      res.result = await getPrivatekey();\n    }\n\n    return createScaffoldMiddleware({\n      private_key: createAsyncMiddleware(getPrivatekeyHandler),\n    });\n  }\n}\n","const __WEBPACK_NAMESPACE_OBJECT__ = require(\"json-rpc-random-id\");","import getCreateRandomId from \"json-rpc-random-id\";\nexport const createRandomId = getCreateRandomId();\n","export * from \"./baseProvider\";\nexport * from \"./commonPrivateKeyProvider\";\nexport * from \"./IBaseProvider\";\nexport * from \"./utils\";\n"],"names":["BaseController","createEventEmitterProxy","WalletInitializationError","ethErrors","BaseProvider","config","state","chainConfig","invalidProviderConfigError","chainId","rpcTarget","defaultState","defaultConfig","networks","_providerEngineProxy","_","Error","rpc","invalidParams","configure","invalidRequest","providerEngineProxy","setTarget","providerFromEngine","createAsyncMiddleware","createScaffoldMiddleware","JRPCEngine","CommonPrivateKeyProvider","privKey","privKeyMiddleware","getPrivKeyMiddleware","engine","push","provider","updateProviderEngineProxy","Promise","resolve","middleware","getPrivatekey","createPrivKeyMiddleware","getPrivatekeyHandler","res","result","private_key","params","providerFactory","setupProvider","getCreateRandomId","createRandomId"],"sourceRoot":""}